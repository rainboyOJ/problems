石头游戏在一个 n 行 m 列 (1≤n,m≤8) 的网格上进行，每个格子对应一种操作序列，操作序列至多有10种，分别用0~9这10个数字指明。

操作序列是一个长度不超过6且循环执行、每秒执行一个字符的字符串。

每秒钟，所有格子同时执行各自操作序列里的下一个字符。

序列中的每个字符是以下格式之一：

1、数字0~9：表示拿0~9个石头到该格子。  
2、NWSE：表示把这个格子内所有的石头推到相邻的格子，N表示上方，W表示左方，S表示下方，E表示右方。  
3、D：表示拿走这个格子的所有石头。

给定每种操作序列对应的字符串，以及网格中每个格子对应的操作序列，求石头游戏进行了 t 秒之后，石头最多的格子里有多少个石头。

在游戏开始时，网格是空的。

#### 输入格式

第一行4个整数n, m, t, act。

接下来n行，每行m个字符，表示每个格子对应的操作序列。

最后act行，每行一个字符串，表示从0开始的每个操作序列。

#### 输出格式

一个整数：游戏进行了t秒之后，所有方格中石头最多的格子有多少个石头。

#### 数据范围

$1 \le m,n \le 8$,  
$1 \le t \le 10^8$,  
$1 \le act \le 10$

#### 输入样例：

```
1 6 10 3
011112
1E
E
0
```

#### 输出样例：

```
3
```

#### 样例解释

样例中给出了三组操作序列，第一个格子执行编号为0的操作序列”1E”,第二至五个格子执行编号为1的操作序列”E”,第六个格子执行编号为2的操作序列”0”。

这是另一个类似于传送带的结构，左边的设备0间隔地产生石头并向东传送。

设备1向右传送，直到设备2。

10秒后，总共产生了5个石头，2个在传送带上，3个在最右边。

## 来源 
- 《算法竞赛进阶指南》
- [acwing](https://www.acwing.com/problem/content/208/) 可能含有视频讲解